<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Poseidon.SequencingSource</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html"><span class="hs-identifier">Poseidon.ColumnTypesSSF</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html"><span class="hs-identifier">Poseidon.ColumnTypesUtils</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.Utils.html"><span class="hs-identifier">Poseidon.Utils</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bchs</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bch</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Csv</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Csv</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rights</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="annot"><span class="hs-comment">-- | A data type to represent a seqSourceFile</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">newtype</span><span> </span><span id="SeqSourceRows"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SeqSourceRows"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getSeqSourceRowList"><span class="annot"><span class="annottext">SeqSourceRows -&gt; [SeqSourceRow]
</span><a href="Poseidon.SequencingSource.html#getSeqSourceRowList"><span class="hs-identifier hs-var hs-var">getSeqSourceRowList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679635857"><span id="local-6989586621679635863"><span id="local-6989586621679635867"><span class="annot"><span class="annottext">Int -&gt; SeqSourceRows -&gt; ShowS
[SeqSourceRows] -&gt; ShowS
SeqSourceRows -&gt; [Char]
(Int -&gt; SeqSourceRows -&gt; ShowS)
-&gt; (SeqSourceRows -&gt; [Char])
-&gt; ([SeqSourceRows] -&gt; ShowS)
-&gt; Show SeqSourceRows
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SeqSourceRows -&gt; ShowS
showsPrec :: Int -&gt; SeqSourceRows -&gt; ShowS
$cshow :: SeqSourceRows -&gt; [Char]
show :: SeqSourceRows -&gt; [Char]
$cshowList :: [SeqSourceRows] -&gt; ShowS
showList :: [SeqSourceRows] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679635872"><span id="local-6989586621679635877"><span class="annot"><span class="annottext">SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
(SeqSourceRows -&gt; SeqSourceRows -&gt; Bool)
-&gt; (SeqSourceRows -&gt; SeqSourceRows -&gt; Bool) -&gt; Eq SeqSourceRows
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
== :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
$c/= :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
/= :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679635885"><span id="local-6989586621679635887"><span class="annot"><span class="annottext">(forall x. SeqSourceRows -&gt; Rep SeqSourceRows x)
-&gt; (forall x. Rep SeqSourceRows x -&gt; SeqSourceRows)
-&gt; Generic SeqSourceRows
forall x. Rep SeqSourceRows x -&gt; SeqSourceRows
forall x. SeqSourceRows -&gt; Rep SeqSourceRows x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SeqSourceRows -&gt; Rep SeqSourceRows x
from :: forall x. SeqSourceRows -&gt; Rep SeqSourceRows x
$cto :: forall x. Rep SeqSourceRows x -&gt; SeqSourceRows
to :: forall x. Rep SeqSourceRows x -&gt; SeqSourceRows
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679635892"><span id="local-6989586621679635896"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679635904"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635904"><span class="hs-identifier hs-var">j1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679635905"><span class="annot"><span class="annottext">&lt;&gt; :: SeqSourceRows -&gt; SeqSourceRows -&gt; SeqSourceRows
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679635906"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635906"><span class="hs-identifier hs-var">j2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="annot"><span class="annottext">([SeqSourceRow] -&gt; SeqSourceRows)
-&gt; [SeqSourceRow] -&gt; SeqSourceRows
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635904"><span class="hs-identifier hs-var">j1</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
</span><a href="#local-6989586621679635907"><span class="hs-operator hs-var">`combineTwoSeqSources`</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635906"><span class="hs-identifier hs-var">j2</span></a></span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="#local-6989586621679635907"><span class="hs-identifier hs-type">combineTwoSeqSources</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-34"></span><span>        </span><span id="local-6989586621679635907"><span class="annot"><span class="annottext">combineTwoSeqSources :: [SeqSourceRow] -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
</span><a href="#local-6989586621679635907"><span class="hs-identifier hs-var hs-var">combineTwoSeqSources</span></a></span></span><span> </span><span id="local-6989586621679635908"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635908"><span class="hs-identifier hs-var">seqSource1</span></a></span></span><span> </span><span id="local-6989586621679635909"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635909"><span class="hs-identifier hs-var">seqSource2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-35"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679635910"><span class="annot"><span class="annottext">simpleSeqSourceSum :: [SeqSourceRow]
</span><a href="#local-6989586621679635910"><span class="hs-identifier hs-var hs-var">simpleSeqSourceSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635908"><span class="hs-identifier hs-var">seqSource1</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635909"><span class="hs-identifier hs-var">seqSource2</span></a></span><span>
</span><span id="line-36"></span><span>                </span><span id="local-6989586621679635912"><span class="annot"><span class="annottext">toAddColNames :: [ByteString]
</span><a href="#local-6989586621679635912"><span class="hs-identifier hs-var hs-var">toAddColNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; [ByteString]
forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">HM.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HashMap ByteString ByteString] -&gt; HashMap ByteString ByteString
forall k v. Eq k =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SeqSourceRow -&gt; HashMap ByteString ByteString)
-&gt; [SeqSourceRow] -&gt; [HashMap ByteString ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.ColumnTypesUtils.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">(CsvNamedRecord -&gt; HashMap ByteString ByteString)
-&gt; (SeqSourceRow -&gt; CsvNamedRecord)
-&gt; SeqSourceRow
-&gt; HashMap ByteString ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635910"><span class="hs-identifier hs-var">simpleSeqSourceSum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>                </span><span id="local-6989586621679635921"><span class="annot"><span class="annottext">toAddEmptyCols :: HashMap ByteString ByteString
</span><a href="#local-6989586621679635921"><span class="hs-identifier hs-var hs-var">toAddEmptyCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; HashMap ByteString ByteString
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; [ByteString] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679635923"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679635923"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679635923"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;n/a&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679635912"><span class="hs-identifier hs-var">toAddColNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(SeqSourceRow -&gt; SeqSourceRow) -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; SeqSourceRow -&gt; SeqSourceRow
</span><a href="#local-6989586621679635924"><span class="hs-identifier hs-var">addEmptyAddColsToSeqSourceRow</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635921"><span class="hs-identifier hs-var">toAddEmptyCols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679635910"><span class="hs-identifier hs-var">simpleSeqSourceSum</span></a></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="#local-6989586621679635924"><span class="hs-identifier hs-type">addEmptyAddColsToSeqSourceRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span>
</span><span id="line-40"></span><span>        </span><span id="local-6989586621679635924"><span class="annot"><span class="annottext">addEmptyAddColsToSeqSourceRow :: HashMap ByteString ByteString -&gt; SeqSourceRow -&gt; SeqSourceRow
</span><a href="#local-6989586621679635924"><span class="hs-identifier hs-var hs-var">addEmptyAddColsToSeqSourceRow</span></a></span></span><span> </span><span id="local-6989586621679635926"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635926"><span class="hs-identifier hs-var">toAdd</span></a></span></span><span> </span><span id="local-6989586621679635927"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679635927"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-41"></span><span>            </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679635927"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#CsvNamedRecord"><span class="hs-identifier hs-type">CsvNamedRecord</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679635929"><span class="hs-identifier hs-type">fillAddCols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679635926"><span class="hs-identifier hs-type">toAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#getCsvNR"><span class="hs-identifier hs-type">getCsvNR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679635927"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="#local-6989586621679635929"><span class="hs-identifier hs-type">fillAddCols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span>
</span><span id="line-43"></span><span>        </span><span id="local-6989586621679635929"><span class="annot"><span class="annottext">fillAddCols :: HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
</span><a href="#local-6989586621679635929"><span class="hs-identifier hs-var hs-var">fillAddCols</span></a></span></span><span> </span><span id="local-6989586621679635930"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635930"><span class="hs-identifier hs-var">toAdd</span></a></span></span><span> </span><span id="local-6989586621679635931"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635931"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
forall k v. Eq k =&gt; HashMap k v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.union</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635931"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635930"><span class="hs-identifier hs-var">toAdd</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
forall k v w.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k w -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.difference`</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679635931"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679635938"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679635943"><span class="annot"><span class="annottext">mempty :: SeqSourceRows
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679635947"><span class="annot"><span class="annottext">mconcat :: [SeqSourceRows] -&gt; SeqSourceRows
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SeqSourceRows -&gt; SeqSourceRows -&gt; SeqSourceRows)
-&gt; SeqSourceRows -&gt; [SeqSourceRows] -&gt; SeqSourceRows
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows -&gt; SeqSourceRows -&gt; SeqSourceRows
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | A data type to represent a row in the seqSourceFile</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- See https://github.com/poseidon-framework/poseidon2-schema/blob/master/seqSourceFile_columns.tsv</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- for more details</span><span>
</span><span id="line-52"></span><span class="hs-keyword">data</span><span> </span><span id="SeqSourceRow"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SeqSourceRow"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sPoseidonID"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn [Char])
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var hs-var">sPoseidonID</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sUDG"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFUDG
</span><a href="Poseidon.SequencingSource.html#sUDG"><span class="hs-identifier hs-var hs-var">sUDG</span></a></span></span><span>                      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryBuilt"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#sLibraryBuilt"><span class="hs-identifier hs-var hs-var">sLibraryBuilt</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSampleAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDSample
</span><a href="Poseidon.SequencingSource.html#sSampleAccession"><span class="hs-identifier hs-var hs-var">sSampleAccession</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFAccessionIDSample"><span class="hs-identifier hs-type">SSFAccessionIDSample</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sStudyAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#sStudyAccession"><span class="hs-identifier hs-var hs-var">sStudyAccession</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFAccessionIDStudy"><span class="hs-identifier hs-type">SSFAccessionIDStudy</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sRunAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var hs-var">sRunAccession</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFAccessionIDRun"><span class="hs-identifier hs-type">SSFAccessionIDRun</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSampleAlias"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFSampleAlias
</span><a href="Poseidon.SequencingSource.html#sSampleAlias"><span class="hs-identifier hs-var hs-var">sSampleAlias</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFSampleAlias"><span class="hs-identifier hs-type">SSFSampleAlias</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSecondarySampleAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFSecondarySampleAccession
</span><a href="Poseidon.SequencingSource.html#sSecondarySampleAccession"><span class="hs-identifier hs-var hs-var">sSecondarySampleAccession</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFSecondarySampleAccession"><span class="hs-identifier hs-type">SSFSecondarySampleAccession</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFirstPublic"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFFirstPublicSimpleDate
</span><a href="Poseidon.SequencingSource.html#sFirstPublic"><span class="hs-identifier hs-var hs-var">sFirstPublic</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFFirstPublicSimpleDate"><span class="hs-identifier hs-type">SSFFirstPublicSimpleDate</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLastUpdated"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLastUpdatedSimpleDate
</span><a href="Poseidon.SequencingSource.html#sLastUpdated"><span class="hs-identifier hs-var hs-var">sLastUpdated</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLastUpdatedSimpleDate"><span class="hs-identifier hs-type">SSFLastUpdatedSimpleDate</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sInstrumentModel"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFInstrumentModel
</span><a href="Poseidon.SequencingSource.html#sInstrumentModel"><span class="hs-identifier hs-var hs-var">sInstrumentModel</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFInstrumentModel"><span class="hs-identifier hs-type">SSFInstrumentModel</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryLayout"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryLayout
</span><a href="Poseidon.SequencingSource.html#sLibraryLayout"><span class="hs-identifier hs-var hs-var">sLibraryLayout</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLibraryLayout"><span class="hs-identifier hs-type">SSFLibraryLayout</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibrarySource"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibrarySource
</span><a href="Poseidon.SequencingSource.html#sLibrarySource"><span class="hs-identifier hs-var hs-var">sLibrarySource</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLibrarySource"><span class="hs-identifier hs-type">SSFLibrarySource</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sInstrumentPlatform"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFInstrumentPlatform
</span><a href="Poseidon.SequencingSource.html#sInstrumentPlatform"><span class="hs-identifier hs-var hs-var">sInstrumentPlatform</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFInstrumentPlatform"><span class="hs-identifier hs-type">SSFInstrumentPlatform</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryName"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryName
</span><a href="Poseidon.SequencingSource.html#sLibraryName"><span class="hs-identifier hs-var hs-var">sLibraryName</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLibraryName"><span class="hs-identifier hs-type">SSFLibraryName</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryStrategy"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryStrategy
</span><a href="Poseidon.SequencingSource.html#sLibraryStrategy"><span class="hs-identifier hs-var hs-var">sLibraryStrategy</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFLibraryStrategy"><span class="hs-identifier hs-type">SSFLibraryStrategy</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqFTP"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqFTPURI)
</span><a href="Poseidon.SequencingSource.html#sFastqFTP"><span class="hs-identifier hs-var hs-var">sFastqFTP</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFFastqFTPURI"><span class="hs-identifier hs-type">SSFFastqFTPURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqASPERA"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqASPERAURI)
</span><a href="Poseidon.SequencingSource.html#sFastqASPERA"><span class="hs-identifier hs-var hs-var">sFastqASPERA</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFFastqASPERAURI"><span class="hs-identifier hs-type">SSFFastqASPERAURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- integer, not int, because it can be a very large number</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqBytes"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqBytes)
</span><a href="Poseidon.SequencingSource.html#sFastqBytes"><span class="hs-identifier hs-var hs-var">sFastqBytes</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFFastqBytes"><span class="hs-identifier hs-type">SSFFastqBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqMD5"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqMD5)
</span><a href="Poseidon.SequencingSource.html#sFastqMD5"><span class="hs-identifier hs-var hs-var">sFastqMD5</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFFastqMD5"><span class="hs-identifier hs-type">SSFFastqMD5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- integer, not int, because it can be a very large number</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sReadCount"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFReadCount
</span><a href="Poseidon.SequencingSource.html#sReadCount"><span class="hs-identifier hs-var hs-var">sReadCount</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFReadCount"><span class="hs-identifier hs-type">SSFReadCount</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSubmittedFTP"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
</span><a href="Poseidon.SequencingSource.html#sSubmittedFTP"><span class="hs-identifier hs-var hs-var">sSubmittedFTP</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#ListColumn"><span class="hs-identifier hs-type">ListColumn</span></a></span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesSSF.html#SSFSubmittedFTPURI"><span class="hs-identifier hs-type">SSFSubmittedFTPURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sAdditionalColumns"><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var hs-var">sAdditionalColumns</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.ColumnTypesUtils.html#CsvNamedRecord"><span class="hs-identifier hs-type">CsvNamedRecord</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679635972"><span id="local-6989586621679636022"><span id="local-6989586621679636025"><span class="annot"><span class="annottext">Int -&gt; SeqSourceRow -&gt; ShowS
[SeqSourceRow] -&gt; ShowS
SeqSourceRow -&gt; [Char]
(Int -&gt; SeqSourceRow -&gt; ShowS)
-&gt; (SeqSourceRow -&gt; [Char])
-&gt; ([SeqSourceRow] -&gt; ShowS)
-&gt; Show SeqSourceRow
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SeqSourceRow -&gt; ShowS
showsPrec :: Int -&gt; SeqSourceRow -&gt; ShowS
$cshow :: SeqSourceRow -&gt; [Char]
show :: SeqSourceRow -&gt; [Char]
$cshowList :: [SeqSourceRow] -&gt; ShowS
showList :: [SeqSourceRow] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679636058"><span id="local-6989586621679636106"><span class="annot"><span class="annottext">SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
(SeqSourceRow -&gt; SeqSourceRow -&gt; Bool)
-&gt; (SeqSourceRow -&gt; SeqSourceRow -&gt; Bool) -&gt; Eq SeqSourceRow
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
== :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
$c/= :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
/= :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679636138"><span id="local-6989586621679636140"><span class="annot"><span class="annottext">(forall x. SeqSourceRow -&gt; Rep SeqSourceRow x)
-&gt; (forall x. Rep SeqSourceRow x -&gt; SeqSourceRow)
-&gt; Generic SeqSourceRow
forall x. Rep SeqSourceRow x -&gt; SeqSourceRow
forall x. SeqSourceRow -&gt; Rep SeqSourceRow x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SeqSourceRow -&gt; Rep SeqSourceRow x
from :: forall x. SeqSourceRow -&gt; Rep SeqSourceRow x
$cto :: forall x. Rep SeqSourceRow x -&gt; SeqSourceRow
to :: forall x. Rep SeqSourceRow x -&gt; SeqSourceRow
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- This header also defines the output column order when writing to csv!</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-type">seqSourceHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bchs.ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span id="seqSourceHeader"><span class="annot"><span class="annottext">seqSourceHeader :: [ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var hs-var">seqSourceHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.DefaultOrdered</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679636146"><span class="annot"><span class="annottext">headerOrder :: SeqSourceRow -&gt; Header
</span><a href="#local-6989586621679636146"><span class="hs-identifier hs-var hs-var hs-var hs-var">headerOrder</span></a></span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Header
</span><span class="hs-identifier hs-var">Csv.header</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceHeaderString"><span class="hs-identifier hs-type">seqSourceHeaderString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span id="seqSourceHeaderString"><span class="annot"><span class="annottext">seqSourceHeaderString :: [[Char]]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeaderString"><span class="hs-identifier hs-var hs-var">seqSourceHeaderString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [Char]) -&gt; [ByteString] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Char]
</span><span class="hs-identifier hs-var">Bchs.unpack</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- This hashmap represents an empty seqSourceFile with all normal, specified columns</span><span>
</span><span id="line-115"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-type">seqSourceRefHashMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bchs.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span id="seqSourceRefHashMap"><span class="annot"><span class="annottext">seqSourceRefHashMap :: HashMap ByteString ()
</span><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-var hs-var">seqSourceRefHashMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ())] -&gt; HashMap ByteString ()
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ())] -&gt; HashMap ByteString ())
-&gt; [(ByteString, ())] -&gt; HashMap ByteString ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ()))
-&gt; [ByteString] -&gt; [(ByteString, ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679636152"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636152"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636152"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromNamedRecord</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679636259"><span class="annot"><span class="annottext">parseNamedRecord :: HashMap ByteString ByteString -&gt; Parser SeqSourceRow
</span><a href="#local-6989586621679636259"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseNamedRecord</span></a></span></span><span> </span><span id="local-6989586621679636261"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ListColumn [Char])
-&gt; Maybe SSFUDG
-&gt; Maybe SSFLibraryBuilt
-&gt; Maybe SSFAccessionIDSample
-&gt; Maybe SSFAccessionIDStudy
-&gt; Maybe SSFAccessionIDRun
-&gt; Maybe SSFSampleAlias
-&gt; Maybe SSFSecondarySampleAccession
-&gt; Maybe SSFFirstPublicSimpleDate
-&gt; Maybe SSFLastUpdatedSimpleDate
-&gt; Maybe SSFInstrumentModel
-&gt; Maybe SSFLibraryLayout
-&gt; Maybe SSFLibrarySource
-&gt; Maybe SSFInstrumentPlatform
-&gt; Maybe SSFLibraryName
-&gt; Maybe SSFLibraryStrategy
-&gt; Maybe (ListColumn SSFFastqFTPURI)
-&gt; Maybe (ListColumn SSFFastqASPERAURI)
-&gt; Maybe (ListColumn SSFFastqBytes)
-&gt; Maybe (ListColumn SSFFastqMD5)
-&gt; Maybe SSFReadCount
-&gt; Maybe (ListColumn SSFSubmittedFTPURI)
-&gt; CsvNamedRecord
-&gt; SeqSourceRow
</span><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">(Maybe (ListColumn [Char])
 -&gt; Maybe SSFUDG
 -&gt; Maybe SSFLibraryBuilt
 -&gt; Maybe SSFAccessionIDSample
 -&gt; Maybe SSFAccessionIDStudy
 -&gt; Maybe SSFAccessionIDRun
 -&gt; Maybe SSFSampleAlias
 -&gt; Maybe SSFSecondarySampleAccession
 -&gt; Maybe SSFFirstPublicSimpleDate
 -&gt; Maybe SSFLastUpdatedSimpleDate
 -&gt; Maybe SSFInstrumentModel
 -&gt; Maybe SSFLibraryLayout
 -&gt; Maybe SSFLibrarySource
 -&gt; Maybe SSFInstrumentPlatform
 -&gt; Maybe SSFLibraryName
 -&gt; Maybe SSFLibraryStrategy
 -&gt; Maybe (ListColumn SSFFastqFTPURI)
 -&gt; Maybe (ListColumn SSFFastqASPERAURI)
 -&gt; Maybe (ListColumn SSFFastqBytes)
 -&gt; Maybe (ListColumn SSFFastqMD5)
 -&gt; Maybe SSFReadCount
 -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
 -&gt; CsvNamedRecord
 -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn [Char]))
-&gt; Parser
     (Maybe SSFUDG
      -&gt; Maybe SSFLibraryBuilt
      -&gt; Maybe SSFAccessionIDSample
      -&gt; Maybe SSFAccessionIDStudy
      -&gt; Maybe SSFAccessionIDRun
      -&gt; Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn [Char]))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFUDG
   -&gt; Maybe SSFLibraryBuilt
   -&gt; Maybe SSFAccessionIDSample
   -&gt; Maybe SSFAccessionIDStudy
   -&gt; Maybe SSFAccessionIDRun
   -&gt; Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFUDG)
-&gt; Parser
     (Maybe SSFLibraryBuilt
      -&gt; Maybe SSFAccessionIDSample
      -&gt; Maybe SSFAccessionIDStudy
      -&gt; Maybe SSFAccessionIDRun
      -&gt; Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFUDG)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLibraryBuilt
   -&gt; Maybe SSFAccessionIDSample
   -&gt; Maybe SSFAccessionIDStudy
   -&gt; Maybe SSFAccessionIDRun
   -&gt; Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLibraryBuilt)
-&gt; Parser
     (Maybe SSFAccessionIDSample
      -&gt; Maybe SSFAccessionIDStudy
      -&gt; Maybe SSFAccessionIDRun
      -&gt; Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLibraryBuilt)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFAccessionIDSample
   -&gt; Maybe SSFAccessionIDStudy
   -&gt; Maybe SSFAccessionIDRun
   -&gt; Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFAccessionIDSample)
-&gt; Parser
     (Maybe SSFAccessionIDStudy
      -&gt; Maybe SSFAccessionIDRun
      -&gt; Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFAccessionIDSample)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFAccessionIDStudy
   -&gt; Maybe SSFAccessionIDRun
   -&gt; Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFAccessionIDStudy)
-&gt; Parser
     (Maybe SSFAccessionIDRun
      -&gt; Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFAccessionIDStudy)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFAccessionIDRun
   -&gt; Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFAccessionIDRun)
-&gt; Parser
     (Maybe SSFSampleAlias
      -&gt; Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFAccessionIDRun)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser a
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookup"><span class="hs-identifier hs-var">filterLookup</span></a></span><span>         </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFSampleAlias
   -&gt; Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFSampleAlias)
-&gt; Parser
     (Maybe SSFSecondarySampleAccession
      -&gt; Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFSampleAlias)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFSecondarySampleAccession
   -&gt; Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFSecondarySampleAccession)
-&gt; Parser
     (Maybe SSFFirstPublicSimpleDate
      -&gt; Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFSecondarySampleAccession)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFFirstPublicSimpleDate
   -&gt; Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFFirstPublicSimpleDate)
-&gt; Parser
     (Maybe SSFLastUpdatedSimpleDate
      -&gt; Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFFirstPublicSimpleDate)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLastUpdatedSimpleDate
   -&gt; Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLastUpdatedSimpleDate)
-&gt; Parser
     (Maybe SSFInstrumentModel
      -&gt; Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLastUpdatedSimpleDate)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFInstrumentModel
   -&gt; Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFInstrumentModel)
-&gt; Parser
     (Maybe SSFLibraryLayout
      -&gt; Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFInstrumentModel)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLibraryLayout
   -&gt; Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLibraryLayout)
-&gt; Parser
     (Maybe SSFLibrarySource
      -&gt; Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLibraryLayout)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLibrarySource
   -&gt; Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLibrarySource)
-&gt; Parser
     (Maybe SSFInstrumentPlatform
      -&gt; Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLibrarySource)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFInstrumentPlatform
   -&gt; Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFInstrumentPlatform)
-&gt; Parser
     (Maybe SSFLibraryName
      -&gt; Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFInstrumentPlatform)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLibraryName
   -&gt; Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLibraryName)
-&gt; Parser
     (Maybe SSFLibraryStrategy
      -&gt; Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLibraryName)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFLibraryStrategy
   -&gt; Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFLibraryStrategy)
-&gt; Parser
     (Maybe (ListColumn SSFFastqFTPURI)
      -&gt; Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFLibraryStrategy)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe (ListColumn SSFFastqFTPURI)
   -&gt; Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn SSFFastqFTPURI))
-&gt; Parser
     (Maybe (ListColumn SSFFastqASPERAURI)
      -&gt; Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn SSFFastqFTPURI))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe (ListColumn SSFFastqASPERAURI)
   -&gt; Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn SSFFastqASPERAURI))
-&gt; Parser
     (Maybe (ListColumn SSFFastqBytes)
      -&gt; Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn SSFFastqASPERAURI))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe (ListColumn SSFFastqBytes)
   -&gt; Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn SSFFastqBytes))
-&gt; Parser
     (Maybe (ListColumn SSFFastqMD5)
      -&gt; Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn SSFFastqBytes))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe (ListColumn SSFFastqMD5)
   -&gt; Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn SSFFastqMD5))
-&gt; Parser
     (Maybe SSFReadCount
      -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord
      -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn SSFFastqMD5))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe SSFReadCount
   -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord
   -&gt; SeqSourceRow)
-&gt; Parser (Maybe SSFReadCount)
-&gt; Parser
     (Maybe (ListColumn SSFSubmittedFTPURI)
      -&gt; CsvNamedRecord -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe SSFReadCount)
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe (ListColumn SSFSubmittedFTPURI)
   -&gt; CsvNamedRecord -&gt; SeqSourceRow)
-&gt; Parser (Maybe (ListColumn SSFSubmittedFTPURI))
-&gt; Parser (CsvNamedRecord -&gt; SeqSourceRow)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; ByteString -&gt; Parser (Maybe (ListColumn SSFSubmittedFTPURI))
forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.ColumnTypesUtils.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-comment">-- beyond that read everything that is not in the set of defined variables</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-comment">-- as a separate hashmap</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">Parser (CsvNamedRecord -&gt; SeqSourceRow)
-&gt; Parser CsvNamedRecord -&gt; Parser SeqSourceRow
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; Parser CsvNamedRecord
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; CsvNamedRecord
</span><a href="Poseidon.ColumnTypesUtils.html#CsvNamedRecord"><span class="hs-identifier hs-var">CsvNamedRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679636261"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; HashMap ByteString () -&gt; HashMap ByteString ByteString
forall k v w.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k w -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.difference`</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ()
</span><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-var">seqSourceRefHashMap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToNamedRecord</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679636372"><span class="annot"><span class="annottext">toNamedRecord :: SeqSourceRow -&gt; HashMap ByteString ByteString
</span><a href="#local-6989586621679636372"><span class="hs-identifier hs-var hs-var hs-var hs-var">toNamedRecord</span></a></span></span><span> </span><span id="local-6989586621679636374"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.ColumnTypesUtils.html#explicitNA"><span class="hs-identifier hs-var">explicitNA</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap ByteString ByteString -&gt; HashMap ByteString ByteString)
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; HashMap ByteString ByteString
</span><span class="hs-identifier hs-var">Csv.namedRecord</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (ListColumn [Char]) -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn [Char])
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var">sPoseidonID</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>                        </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFUDG -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFUDG
</span><a href="Poseidon.SequencingSource.html#sUDG"><span class="hs-identifier hs-var">sUDG</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>              </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFLibraryBuilt -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#sLibraryBuilt"><span class="hs-identifier hs-var">sLibraryBuilt</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>           </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe SSFAccessionIDSample -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDSample
</span><a href="Poseidon.SequencingSource.html#sSampleAccession"><span class="hs-identifier hs-var">sSampleAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFAccessionIDStudy -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#sStudyAccession"><span class="hs-identifier hs-var">sStudyAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>              </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFAccessionIDRun -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var">sRunAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFSampleAlias -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFSampleAlias
</span><a href="Poseidon.SequencingSource.html#sSampleAlias"><span class="hs-identifier hs-var">sSampleAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe SSFSecondarySampleAccession -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFSecondarySampleAccession
</span><a href="Poseidon.SequencingSource.html#sSecondarySampleAccession"><span class="hs-identifier hs-var">sSecondarySampleAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe SSFFirstPublicSimpleDate -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFFirstPublicSimpleDate
</span><a href="Poseidon.SequencingSource.html#sFirstPublic"><span class="hs-identifier hs-var">sFirstPublic</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe SSFLastUpdatedSimpleDate -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLastUpdatedSimpleDate
</span><a href="Poseidon.SequencingSource.html#sLastUpdated"><span class="hs-identifier hs-var">sLastUpdated</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>           </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFInstrumentModel -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFInstrumentModel
</span><a href="Poseidon.SequencingSource.html#sInstrumentModel"><span class="hs-identifier hs-var">sInstrumentModel</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>             </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFLibraryLayout -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryLayout
</span><a href="Poseidon.SequencingSource.html#sLibraryLayout"><span class="hs-identifier hs-var">sLibraryLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>             </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFLibrarySource -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibrarySource
</span><a href="Poseidon.SequencingSource.html#sLibrarySource"><span class="hs-identifier hs-var">sLibrarySource</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>        </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe SSFInstrumentPlatform -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFInstrumentPlatform
</span><a href="Poseidon.SequencingSource.html#sInstrumentPlatform"><span class="hs-identifier hs-var">sInstrumentPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFLibraryName -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryName
</span><a href="Poseidon.SequencingSource.html#sLibraryName"><span class="hs-identifier hs-var">sLibraryName</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>           </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFLibraryStrategy -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryStrategy
</span><a href="Poseidon.SequencingSource.html#sLibraryStrategy"><span class="hs-identifier hs-var">sLibraryStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>                  </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe (ListColumn SSFFastqFTPURI) -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqFTPURI)
</span><a href="Poseidon.SequencingSource.html#sFastqFTP"><span class="hs-identifier hs-var">sFastqFTP</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>               </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe (ListColumn SSFFastqASPERAURI) -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqASPERAURI)
</span><a href="Poseidon.SequencingSource.html#sFastqASPERA"><span class="hs-identifier hs-var">sFastqASPERA</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>                </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe (ListColumn SSFFastqBytes) -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqBytes)
</span><a href="Poseidon.SequencingSource.html#sFastqBytes"><span class="hs-identifier hs-var">sFastqBytes</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>                  </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe (ListColumn SSFFastqMD5) -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFFastqMD5)
</span><a href="Poseidon.SequencingSource.html#sFastqMD5"><span class="hs-identifier hs-var">sFastqMD5</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>                 </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe SSFReadCount -&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFReadCount
</span><a href="Poseidon.SequencingSource.html#sReadCount"><span class="hs-identifier hs-var">sReadCount</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>              </span><span class="annot"><span class="annottext">ByteString
-&gt; Maybe (ListColumn SSFSubmittedFTPURI)
-&gt; (ByteString, ByteString)
forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn SSFSubmittedFTPURI)
</span><a href="Poseidon.SequencingSource.html#sSubmittedFTP"><span class="hs-identifier hs-var">sSubmittedFTP</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-comment">-- beyond that add what is in the hashmap of additional columns</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
forall k v. Eq k =&gt; HashMap k v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.union`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.ColumnTypesUtils.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">(CsvNamedRecord -&gt; HashMap ByteString ByteString)
-&gt; CsvNamedRecord -&gt; HashMap ByteString ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636374"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | A function to write one seqSourceFile</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Poseidon.SequencingSource.html#writeSeqSourceFile"><span class="hs-identifier hs-type">writeSeqSourceFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="writeSeqSourceFile"><span class="annot"><span class="annottext">writeSeqSourceFile :: [Char] -&gt; SeqSourceRows -&gt; IO ()
</span><a href="Poseidon.SequencingSource.html#writeSeqSourceFile"><span class="hs-identifier hs-var hs-var">writeSeqSourceFile</span></a></span></span><span> </span><span id="local-6989586621679636380"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636380"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679636381"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636381"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636383"><span class="annot"><span class="annottext">seqSourceAsBytestring :: ByteString
</span><a href="#local-6989586621679636383"><span class="hs-identifier hs-var hs-var">seqSourceAsBytestring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncodeOptions -&gt; Header -&gt; [SeqSourceRow] -&gt; ByteString
forall a.
ToNamedRecord a =&gt;
EncodeOptions -&gt; Header -&gt; [a] -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.encodeByNameWith</span></span><span> </span><span class="annot"><span class="annottext">EncodeOptions
</span><a href="Poseidon.ColumnTypesUtils.html#encodingOptions"><span class="hs-identifier hs-var">encodingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="#local-6989586621679636386"><span class="hs-identifier hs-var">makeHeaderWithAdditionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636381"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">Bch.writeFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636380"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636383"><span class="hs-identifier hs-var">seqSourceAsBytestring</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="#local-6989586621679636386"><span class="hs-identifier hs-type">makeHeaderWithAdditionalColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.Header</span></span><span>
</span><span id="line-180"></span><span>        </span><span id="local-6989586621679636386"><span class="annot"><span class="annottext">makeHeaderWithAdditionalColumns :: Header
</span><a href="#local-6989586621679636386"><span class="hs-identifier hs-var hs-var">makeHeaderWithAdditionalColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">[ByteString] -&gt; Header
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; Header) -&gt; [ByteString] -&gt; Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; [ByteString]
forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">HM.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HashMap ByteString ByteString] -&gt; HashMap ByteString ByteString
forall k v. Eq k =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SeqSourceRow -&gt; HashMap ByteString ByteString)
-&gt; [SeqSourceRow] -&gt; [HashMap ByteString ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.ColumnTypesUtils.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">(CsvNamedRecord -&gt; HashMap ByteString ByteString)
-&gt; (SeqSourceRow -&gt; CsvNamedRecord)
-&gt; SeqSourceRow
-&gt; HashMap ByteString ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636381"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | A function to read one seqSourceFile</span></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Poseidon.SequencingSource.html#readSeqSourceFile"><span class="hs-identifier hs-type">readSeqSourceFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span>
</span><span id="line-185"></span><span id="readSeqSourceFile"><span class="annot"><span class="annottext">readSeqSourceFile :: [Char] -&gt; PoseidonIO SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFile"><span class="hs-identifier hs-var hs-var">readSeqSourceFile</span></a></span></span><span> </span><span id="local-6989586621679636390"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PoseidonIO ()) -&gt; [Char] -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Reading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679636392"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636392"><span class="hs-identifier hs-var">seqSourceFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ReaderT Env IO ByteString
forall a. IO a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; ReaderT Env IO ByteString)
-&gt; IO ByteString -&gt; ReaderT Env IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Bch.readFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636394"><span class="annot"><span class="annottext">seqSourceFileRows :: [ByteString]
</span><a href="#local-6989586621679636394"><span class="hs-identifier hs-var hs-var">seqSourceFileRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">Bch.lines</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636392"><span class="hs-identifier hs-var">seqSourceFile</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679636394"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO () -&gt; PoseidonIO ()) -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; PoseidonIO ()
forall a. IO a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PoseidonIO ()) -&gt; IO () -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonException -&gt; IO ()) -&gt; PoseidonException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-var">PoseidonFileConsistencyException</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;File has less than two lines&quot;</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PoseidonIO ()) -&gt; [Char] -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679636394"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; sequencing entities in this file&quot;</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- tupel with row number and row bytestring</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636404"><span class="annot"><span class="annottext">seqSourceFileRowsWithNumber :: [(Int, ByteString)]
</span><a href="#local-6989586621679636404"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [ByteString] -&gt; [(Int, ByteString)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679636394"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679636394"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- filter out empty lines</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679636407"><span class="annot"><span class="annottext">seqSourceFileRowsWithNumberFiltered :: [(Int, ByteString)]
</span><a href="#local-6989586621679636407"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, ByteString) -&gt; Bool)
-&gt; [(Int, ByteString)] -&gt; [(Int, ByteString)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679636408"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636408"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636408"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Bch.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679636404"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumber</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- create header + individual line combination</span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621679636413"><span class="annot"><span class="annottext">headerOnlyPotentiallyWithQuotes :: ByteString
</span><a href="#local-6989586621679636413"><span class="hs-identifier hs-var hs-var">headerOnlyPotentiallyWithQuotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, ByteString) -&gt; ByteString)
-&gt; (Int, ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)] -&gt; (Int, ByteString)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679636407"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">-- removing the quotes like this might cause issues in edge cases</span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679636417"><span class="annot"><span class="annottext">headerOnly :: ByteString
</span><a href="#local-6989586621679636417"><span class="hs-identifier hs-var hs-var">headerOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Bch.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636413"><span class="hs-identifier hs-var">headerOnlyPotentiallyWithQuotes</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679636421"><span class="annot"><span class="annottext">rowsOnly :: [(Int, ByteString)]
</span><a href="#local-6989586621679636421"><span class="hs-identifier hs-var hs-var">rowsOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)] -&gt; [(Int, ByteString)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679636407"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621679636430"><span class="annot"><span class="annottext">seqSourceFileRowsWithHeader :: [(Int, ByteString)]
</span><a href="#local-6989586621679636430"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, ByteString) -&gt; (Int, ByteString))
-&gt; [(Int, ByteString)] -&gt; [(Int, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Int, ByteString) -&gt; (Int, ByteString)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679636431"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636431"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636417"><span class="hs-identifier hs-var">headerOnly</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636431"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679636421"><span class="hs-identifier hs-var">rowsOnly</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- read seqSourceFile by rows</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679636432"><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679636432"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Int, ByteString)
 -&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow))
-&gt; [(Int, ByteString)]
-&gt; ReaderT Env IO [Either PoseidonException SeqSourceRow]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
-&gt; (Int, ByteString)
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-var">readSeqSourceFileRow</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679636430"><span class="hs-identifier hs-var">seqSourceFileRowsWithHeader</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- error case management</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PoseidonException] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow] -&gt; [PoseidonException]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679636432"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">(PoseidonException -&gt; PoseidonIO ())
-&gt; [PoseidonException] -&gt; PoseidonIO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PoseidonIO ())
-&gt; (PoseidonException -&gt; [Char])
-&gt; PoseidonException
-&gt; PoseidonIO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; [Char]
</span><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PoseidonException] -&gt; PoseidonIO ())
-&gt; [PoseidonException] -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [PoseidonException] -&gt; [PoseidonException]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">([PoseidonException] -&gt; [PoseidonException])
-&gt; [PoseidonException] -&gt; [PoseidonException]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow] -&gt; [PoseidonException]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679636432"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">IO SeqSourceRows -&gt; PoseidonIO SeqSourceRows
forall a. IO a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO SeqSourceRows -&gt; PoseidonIO SeqSourceRows)
-&gt; IO SeqSourceRows -&gt; PoseidonIO SeqSourceRows
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO SeqSourceRows
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonException -&gt; IO SeqSourceRows)
-&gt; PoseidonException -&gt; IO SeqSourceRows
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-var">PoseidonFileConsistencyException</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Broken lines.&quot;</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636441"><span class="annot"><span class="annottext">seqSource :: SeqSourceRows
</span><a href="#local-6989586621679636441"><span class="hs-identifier hs-var hs-var">seqSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="annot"><span class="annottext">([SeqSourceRow] -&gt; SeqSourceRows)
-&gt; [SeqSourceRow] -&gt; SeqSourceRows
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow] -&gt; [SeqSourceRow]
forall a b. [Either a b] -&gt; [b]
</span><span class="hs-identifier hs-var">rights</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679636432"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; SeqSourceRows -&gt; PoseidonIO ()
</span><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-var">warnSeqSourceConsistency</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636390"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679636441"><span class="hs-identifier hs-var">seqSource</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">SeqSourceRows -&gt; PoseidonIO SeqSourceRows
forall a. a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679636441"><span class="hs-identifier hs-var">seqSource</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | A function to read one row of a seqSourceFile</span></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-type">readSeqSourceFileRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bch.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span id="readSeqSourceFileRow"><span class="annot"><span class="annottext">readSeqSourceFileRow :: [Char]
-&gt; (Int, ByteString)
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-var hs-var">readSeqSourceFileRow</span></a></span></span><span> </span><span id="local-6989586621679636443"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636443"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679636444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679636444"><span class="hs-identifier hs-var">lineNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679636445"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636445"><span class="hs-identifier hs-var">row</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636447"><span class="annot"><span class="annottext">decoded :: Either [Char] (Header, Vector SeqSourceRow)
</span><a href="#local-6989586621679636447"><span class="hs-identifier hs-var hs-var">decoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DecodeOptions
-&gt; ByteString -&gt; Either [Char] (Header, Vector SeqSourceRow)
forall a.
FromNamedRecord a =&gt;
DecodeOptions -&gt; ByteString -&gt; Either [Char] (Header, Vector a)
</span><span class="hs-identifier hs-var">Csv.decodeByNameWith</span></span><span> </span><span class="annot"><span class="annottext">DecodeOptions
</span><a href="Poseidon.ColumnTypesUtils.html#decodingOptions"><span class="hs-identifier hs-var">decodingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679636445"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679636452"><span class="annot"><span class="annottext">simplifiedDecoded :: Either [Char] SeqSourceRow
</span><a href="#local-6989586621679636452"><span class="hs-identifier hs-var hs-var">simplifiedDecoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Header
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679636453"><span class="annot"><span class="annottext">Vector SeqSourceRow
</span><a href="#local-6989586621679636453"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector SeqSourceRow -&gt; SeqSourceRow
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector SeqSourceRow
</span><a href="#local-6989586621679636453"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Header, Vector SeqSourceRow) -&gt; SeqSourceRow)
-&gt; Either [Char] (Header, Vector SeqSourceRow)
-&gt; Either [Char] SeqSourceRow
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either [Char] (Header, Vector SeqSourceRow)
</span><a href="#local-6989586621679636447"><span class="hs-identifier hs-var">decoded</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] SeqSourceRow
</span><a href="#local-6989586621679636452"><span class="hs-identifier hs-var">simplifiedDecoded</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679636455"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636455"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636460"><span class="annot"><span class="annottext">betterError :: [Char]
</span><a href="#local-6989586621679636460"><span class="hs-identifier hs-var hs-var">betterError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parsec [Char] () CsvParseError
-&gt; [Char] -&gt; [Char] -&gt; Either ParseError CsvParseError
forall s t a.
Stream s Identity t =&gt;
Parsec s () a -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">P.parse</span></span><span> </span><span class="annot"><span class="annottext">Parsec [Char] () CsvParseError
</span><a href="Poseidon.ColumnTypesUtils.html#parseCsvParseError"><span class="hs-identifier hs-var">parseCsvParseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636455"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Poseidon.ColumnTypesUtils.html#removeUselessSuffix"><span class="hs-identifier hs-var">removeUselessSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636455"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-222"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679636464"><span class="annot"><span class="annottext">CsvParseError
</span><a href="#local-6989586621679636464"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CsvParseError -&gt; [Char]
</span><a href="Poseidon.ColumnTypesUtils.html#renderCsvParseError"><span class="hs-identifier hs-var">renderCsvParseError</span></a></span><span> </span><span class="annot"><span class="annottext">CsvParseError
</span><a href="#local-6989586621679636464"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="annot"><span class="annottext">Either PoseidonException SeqSourceRow
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
forall a. a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either PoseidonException SeqSourceRow
 -&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow))
-&gt; Either PoseidonException SeqSourceRow
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; Either PoseidonException SeqSourceRow
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonException -&gt; Either PoseidonException SeqSourceRow)
-&gt; PoseidonException -&gt; Either PoseidonException SeqSourceRow
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char] -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileRowException"><span class="hs-identifier hs-var">PoseidonFileRowException</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636443"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679636444"><span class="hs-identifier hs-var">lineNumber</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636460"><span class="hs-identifier hs-var">betterError</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679636467"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636467"><span class="hs-identifier hs-var">seqSourceRow</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>            </span><span class="annot"><span class="annottext">Either PoseidonException SeqSourceRow
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
forall a. a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either PoseidonException SeqSourceRow
 -&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow))
-&gt; Either PoseidonException SeqSourceRow
-&gt; ReaderT Env IO (Either PoseidonException SeqSourceRow)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Either PoseidonException SeqSourceRow
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679636467"><span class="hs-identifier hs-var">seqSourceRow</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- Global SSF consistency checks</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-type">warnSeqSourceConsistency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span id="warnSeqSourceConsistency"><span class="annot"><span class="annottext">warnSeqSourceConsistency :: [Char] -&gt; SeqSourceRows -&gt; PoseidonIO ()
</span><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-var hs-var">warnSeqSourceConsistency</span></a></span></span><span> </span><span id="local-6989586621679636468"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636468"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span id="local-6989586621679636469"><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679636469"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-var">checkRunsUnique</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679636469"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO () -&gt; PoseidonIO ()) -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var">logWarning</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PoseidonIO ()) -&gt; [Char] -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Potential consistency issues in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636468"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-233"></span><span>                     </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The values in the run_accession column are not unique&quot;</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-var">checkAtLeastOnePoseidonID</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679636469"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO () -&gt; PoseidonIO ()) -&gt; PoseidonIO () -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var">logWarning</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PoseidonIO ()) -&gt; [Char] -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Potential consistency issues in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679636468"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-236"></span><span>                     </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The poseidon_IDs column is completely empty. Package and .ssf file are not linked&quot;</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-type">checkRunsUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-239"></span><span id="checkRunsUnique"><span class="annot"><span class="annottext">checkRunsUnique :: SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-var hs-var">checkRunsUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679636473"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636473"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679636474"><span class="annot"><span class="annottext">justRunAccessions :: [SSFAccessionIDRun]
</span><a href="#local-6989586621679636474"><span class="hs-identifier hs-var hs-var">justRunAccessions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SeqSourceRow -&gt; Maybe SSFAccessionIDRun)
-&gt; [SeqSourceRow] -&gt; [SSFAccessionIDRun]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFAccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var">sRunAccession</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636473"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[SSFAccessionIDRun]
</span><a href="#local-6989586621679636474"><span class="hs-identifier hs-var">justRunAccessions</span></a></span><span> </span><span class="annot"><span class="annottext">[SSFAccessionIDRun] -&gt; [SSFAccessionIDRun] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[SSFAccessionIDRun] -&gt; [SSFAccessionIDRun]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">[SSFAccessionIDRun]
</span><a href="#local-6989586621679636474"><span class="hs-identifier hs-var">justRunAccessions</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-type">checkAtLeastOnePoseidonID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-244"></span><span id="checkAtLeastOnePoseidonID"><span class="annot"><span class="annottext">checkAtLeastOnePoseidonID :: SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-var hs-var">checkAtLeastOnePoseidonID</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679636475"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636475"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">(SeqSourceRow -&gt; Bool) -&gt; [SeqSourceRow] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (ListColumn [Char]) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ListColumn [Char]) -&gt; Bool)
-&gt; (SeqSourceRow -&gt; Maybe (ListColumn [Char]))
-&gt; SeqSourceRow
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (ListColumn [Char])
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var">sPoseidonID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679636475"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-246"></span></pre></body></html>