<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Poseidon.Utils</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier">renderPoseidonException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier">usePoseidonLogger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#testLog"><span class="hs-identifier">testLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier">PoseidonIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#envLogAction"><span class="hs-identifier">envLogAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#envInputPlinkMode"><span class="hs-identifier">envInputPlinkMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier">LogMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier">checkFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier">getChecksum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier">logWarning</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier">logInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logError"><span class="hs-identifier">logError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier">LogA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier">noLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier">logWithEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#padRight"><span class="hs-identifier">padRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#padLeft"><span class="hs-identifier">padLeft</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#determinePackageOutName"><span class="hs-identifier">determinePackageOutName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-identifier">PlinkPopNameMode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#TestMode"><span class="hs-identifier">TestMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#Env"><span class="hs-identifier">Env</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#uniquePO"><span class="hs-identifier">uniquePO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#uniqueRO"><span class="hs-identifier">uniqueRO</span></a></span><span>
</span><span id="line-27"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Paths_poseidon_hs.html"><span class="hs-identifier">Paths_poseidon_hs</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Paths_poseidon_hs.html#version"><span class="hs-identifier">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Colog</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasLog</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogAction</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Message</span></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>                                         </span><span class="annot"><span class="hs-identifier">Msg</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cfilter</span></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                                         </span><span class="annot"><span class="hs-identifier">cmapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logTextStderr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">msgSeverity</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                         </span><span class="annot"><span class="hs-identifier">msgText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showSeverity</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Exception</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception.Base</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeException</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwM</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LB</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Digest.Pure.MD5</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">md5</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>                                         </span><span class="annot"><span class="hs-identifier">getCurrentTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">utcToLocalZonedTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Version</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showVersion</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Yaml</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ParseException</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">callStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFrozenCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HttpException</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">SequenceFormats.Plink</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PlinkPopNameMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">doesFileExist</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.FilePath.Posix</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">takeBaseName</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span id="LogA"><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-var">LogA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogAction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">data</span><span> </span><span id="TestMode"><span class="annot"><a href="Poseidon.Utils.html#TestMode"><span class="hs-identifier hs-var">TestMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Testing"><span class="annot"><a href="Poseidon.Utils.html#Testing"><span class="hs-identifier hs-var">Testing</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Production"><span class="annot"><a href="Poseidon.Utils.html#Production"><span class="hs-identifier hs-var">Production</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679474823"><span id="local-6989586621679474825"><span id="local-6989586621679474829"><span class="annot"><span class="annottext">Int -&gt; TestMode -&gt; ShowS
[TestMode] -&gt; ShowS
TestMode -&gt; String
(Int -&gt; TestMode -&gt; ShowS)
-&gt; (TestMode -&gt; String) -&gt; ([TestMode] -&gt; ShowS) -&gt; Show TestMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TestMode -&gt; ShowS
showsPrec :: Int -&gt; TestMode -&gt; ShowS
$cshow :: TestMode -&gt; String
show :: TestMode -&gt; String
$cshowList :: [TestMode] -&gt; ShowS
showList :: [TestMode] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="Env"><span class="annot"><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Env"><span class="annot"><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-60"></span><span>    </span><span id="_envLogAction"><span class="annot"><span class="annottext">Env -&gt; LogA
</span><a href="Poseidon.Utils.html#_envLogAction"><span class="hs-identifier hs-var hs-var">_envLogAction</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span id="_envTestMode"><span class="annot"><span class="annottext">Env -&gt; TestMode
</span><a href="Poseidon.Utils.html#_envTestMode"><span class="hs-identifier hs-var hs-var">_envTestMode</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#TestMode"><span class="hs-identifier hs-type">TestMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span id="_envInputPlinkMode"><span class="annot"><span class="annottext">Env -&gt; PlinkPopNameMode
</span><a href="Poseidon.Utils.html#_envInputPlinkMode"><span class="hs-identifier hs-var hs-var">_envInputPlinkMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlinkPopNameMode</span></span><span>
</span><span id="line-63"></span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Poseidon.Utils.html#defaultEnv"><span class="hs-identifier hs-type">defaultEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-66"></span><span id="defaultEnv"><span class="annot"><span class="annottext">defaultEnv :: LogA -&gt; Env
</span><a href="Poseidon.Utils.html#defaultEnv"><span class="hs-identifier hs-var hs-var">defaultEnv</span></a></span></span><span> </span><span id="local-6989586621679474837"><span class="annot"><span class="annottext">LogA
</span><a href="#local-6989586621679474837"><span class="hs-identifier hs-var">logA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="#local-6989586621679474837"><span class="hs-identifier hs-var">logA</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="Poseidon.Utils.html#Production"><span class="hs-identifier hs-var">Production</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><span class="hs-identifier hs-var">PlinkPopNameAsFamily</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">type</span><span> </span><span id="PoseidonIO"><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-var">PoseidonIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- just two convenience helper functions</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Poseidon.Utils.html#envLogAction"><span class="hs-identifier hs-type">envLogAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-72"></span><span id="envLogAction"><span class="annot"><span class="annottext">envLogAction :: PoseidonIO LogA
</span><a href="Poseidon.Utils.html#envLogAction"><span class="hs-identifier hs-var hs-var">envLogAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; LogA) -&gt; PoseidonIO LogA
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; LogA
</span><a href="Poseidon.Utils.html#_envLogAction"><span class="hs-identifier hs-var">_envLogAction</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Poseidon.Utils.html#envInputPlinkMode"><span class="hs-identifier hs-type">envInputPlinkMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlinkPopNameMode</span></span><span>
</span><span id="line-75"></span><span id="envInputPlinkMode"><span class="annot"><span class="annottext">envInputPlinkMode :: PoseidonIO PlinkPopNameMode
</span><a href="Poseidon.Utils.html#envInputPlinkMode"><span class="hs-identifier hs-var hs-var">envInputPlinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; PlinkPopNameMode) -&gt; PoseidonIO PlinkPopNameMode
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; PlinkPopNameMode
</span><a href="Poseidon.Utils.html#_envInputPlinkMode"><span class="hs-identifier hs-var">_envInputPlinkMode</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="LogMode"><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier hs-var">LogMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoLog"><span class="annot"><a href="Poseidon.Utils.html#NoLog"><span class="hs-identifier hs-var">NoLog</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SimpleLog"><span class="annot"><a href="Poseidon.Utils.html#SimpleLog"><span class="hs-identifier hs-var">SimpleLog</span></a></span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DefaultLog"><span class="annot"><a href="Poseidon.Utils.html#DefaultLog"><span class="hs-identifier hs-var">DefaultLog</span></a></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ServerLog"><span class="annot"><a href="Poseidon.Utils.html#ServerLog"><span class="hs-identifier hs-var">ServerLog</span></a></span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="VerboseLog"><span class="annot"><a href="Poseidon.Utils.html#VerboseLog"><span class="hs-identifier hs-var">VerboseLog</span></a></span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679474845"><span id="local-6989586621679474847"><span id="local-6989586621679474851"><span class="annot"><span class="annottext">Int -&gt; LogMode -&gt; ShowS
[LogMode] -&gt; ShowS
LogMode -&gt; String
(Int -&gt; LogMode -&gt; ShowS)
-&gt; (LogMode -&gt; String) -&gt; ([LogMode] -&gt; ShowS) -&gt; Show LogMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; LogMode -&gt; ShowS
showsPrec :: Int -&gt; LogMode -&gt; ShowS
$cshow :: LogMode -&gt; String
show :: LogMode -&gt; String
$cshowList :: [LogMode] -&gt; ShowS
showList :: [LogMode] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679474562"><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-type">usePoseidonLogger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier hs-type">LogMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#TestMode"><span class="hs-identifier hs-type">TestMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlinkPopNameMode</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679474562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679474562"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-85"></span><span id="usePoseidonLogger"><span class="annot"><span class="annottext">usePoseidonLogger :: forall a.
LogMode -&gt; TestMode -&gt; PlinkPopNameMode -&gt; PoseidonIO a -&gt; IO a
</span><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var hs-var">usePoseidonLogger</span></a></span></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#NoLog"><span class="hs-identifier hs-var">NoLog</span></a></span><span>      </span><span id="local-6989586621679474853"><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474853"><span class="hs-identifier hs-var">testMode</span></a></span></span><span> </span><span id="local-6989586621679474854"><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474854"><span class="hs-identifier hs-var">plinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO a -&gt; Env -&gt; IO a) -&gt; Env -&gt; PoseidonIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO a -&gt; Env -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-var">noLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474853"><span class="hs-identifier hs-var">testMode</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474854"><span class="hs-identifier hs-var">plinkMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#SimpleLog"><span class="hs-identifier hs-var">SimpleLog</span></a></span><span>  </span><span id="local-6989586621679474856"><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474856"><span class="hs-identifier hs-var">testMode</span></a></span></span><span> </span><span id="local-6989586621679474857"><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474857"><span class="hs-identifier hs-var">plinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO a -&gt; Env -&gt; IO a) -&gt; Env -&gt; PoseidonIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO a -&gt; Env -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var">simpleLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474856"><span class="hs-identifier hs-var">testMode</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474857"><span class="hs-identifier hs-var">plinkMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#DefaultLog"><span class="hs-identifier hs-var">DefaultLog</span></a></span><span> </span><span id="local-6989586621679474859"><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474859"><span class="hs-identifier hs-var">testMode</span></a></span></span><span> </span><span id="local-6989586621679474860"><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474860"><span class="hs-identifier hs-var">plinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO a -&gt; Env -&gt; IO a) -&gt; Env -&gt; PoseidonIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO a -&gt; Env -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-var">defaultLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474859"><span class="hs-identifier hs-var">testMode</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474860"><span class="hs-identifier hs-var">plinkMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#ServerLog"><span class="hs-identifier hs-var">ServerLog</span></a></span><span>  </span><span id="local-6989586621679474862"><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474862"><span class="hs-identifier hs-var">testMode</span></a></span></span><span> </span><span id="local-6989586621679474863"><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474863"><span class="hs-identifier hs-var">plinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO a -&gt; Env -&gt; IO a) -&gt; Env -&gt; PoseidonIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO a -&gt; Env -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-var">serverLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474862"><span class="hs-identifier hs-var">testMode</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474863"><span class="hs-identifier hs-var">plinkMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#VerboseLog"><span class="hs-identifier hs-var">VerboseLog</span></a></span><span> </span><span id="local-6989586621679474865"><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474865"><span class="hs-identifier hs-var">testMode</span></a></span></span><span> </span><span id="local-6989586621679474866"><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474866"><span class="hs-identifier hs-var">plinkMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonIO a -&gt; Env -&gt; IO a) -&gt; Env -&gt; PoseidonIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO a -&gt; Env -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; TestMode -&gt; PlinkPopNameMode -&gt; Env
</span><a href="Poseidon.Utils.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-var">verboseLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="#local-6989586621679474865"><span class="hs-identifier hs-var">testMode</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><a href="#local-6989586621679474866"><span class="hs-identifier hs-var">plinkMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679474570"><span class="annot"><a href="Poseidon.Utils.html#testLog"><span class="hs-identifier hs-type">testLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679474570"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679474570"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-92"></span><span id="testLog"><span class="annot"><span class="annottext">testLog :: forall a. PoseidonIO a -&gt; IO a
</span><a href="Poseidon.Utils.html#testLog"><span class="hs-identifier hs-var hs-var">testLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogMode -&gt; TestMode -&gt; PlinkPopNameMode -&gt; PoseidonIO a -&gt; IO a
forall a.
LogMode -&gt; TestMode -&gt; PlinkPopNameMode -&gt; PoseidonIO a -&gt; IO a
</span><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#NoLog"><span class="hs-identifier hs-var">NoLog</span></a></span><span> </span><span class="annot"><span class="annottext">TestMode
</span><a href="Poseidon.Utils.html#Testing"><span class="hs-identifier hs-var">Testing</span></a></span><span> </span><span class="annot"><span class="annottext">PlinkPopNameMode
</span><span class="hs-identifier hs-var">PlinkPopNameAsFamily</span></span><span>
</span><span id="line-93"></span><span class="hs-comment">--testLog = usePoseidonLogger VerboseLog Testing PlinkPopNameAsFamily</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-type">noLog</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-96"></span><span id="noLog"><span class="annot"><span class="annottext">noLog :: LogA
</span><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-var hs-var">noLog</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; Bool) -&gt; LogA -&gt; LogA
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Msg Severity -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var">simpleLog</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-type">simpleLog</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-98"></span><span id="simpleLog"><span class="annot"><span class="annottext">simpleLog :: LogA
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var hs-var">simpleLog</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; Bool) -&gt; LogA -&gt; LogA
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679474869"><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474869"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474869"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogA -&gt; LogA) -&gt; LogA -&gt; LogA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; LogA
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-type">defaultLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-100"></span><span id="defaultLog"><span class="annot"><span class="annottext">defaultLog :: LogA
</span><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-var hs-var">defaultLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; Bool) -&gt; LogA -&gt; LogA
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679474873"><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474873"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474873"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogA -&gt; LogA) -&gt; LogA -&gt; LogA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; LogA
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-type">serverLog</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-102"></span><span id="serverLog"><span class="annot"><span class="annottext">serverLog :: LogA
</span><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-var hs-var">serverLog</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; Bool) -&gt; LogA -&gt; LogA
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679474874"><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474874"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474874"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogA -&gt; LogA) -&gt; LogA -&gt; LogA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; LogA
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-type">verboseLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-104"></span><span id="verboseLog"><span class="annot"><span class="annottext">verboseLog :: LogA
</span><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-var hs-var">verboseLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; LogA
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-type">compileLogMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span>
</span><span id="line-107"></span><span id="compileLogMsg"><span class="annot"><span class="annottext">compileLogMsg :: Bool -&gt; Bool -&gt; LogA
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var hs-var">compileLogMsg</span></a></span></span><span> </span><span id="local-6989586621679474875"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679474875"><span class="hs-identifier hs-var">severity</span></a></span></span><span> </span><span id="local-6989586621679474876"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; IO Text) -&gt; LogAction IO Text -&gt; LogA
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LogAction m b -&gt; LogAction m a
</span><span class="hs-identifier hs-var">cmapM</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; IO Text
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">prepareMessage</span></a></span><span> </span><span class="annot"><span class="annottext">LogAction IO Text
forall (m :: * -&gt; *). MonadIO m =&gt; LogAction m Text
</span><span class="hs-identifier hs-var">logTextStderr</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><a href="#local-6989586621679474877"><span class="hs-identifier hs-type">prepareMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679474877"><span class="annot"><span class="annottext">prepareMessage :: Msg Severity -&gt; IO Text
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var hs-var">prepareMessage</span></a></span></span><span> </span><span id="local-6989586621679474878"><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474879"><span class="annot"><span class="annottext">textMessage :: Text
</span><a href="#local-6989586621679474879"><span class="hs-identifier hs-var hs-var">textMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; Text
forall sev. Msg sev -&gt; Text
</span><span class="hs-identifier hs-var">msgText</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span id="local-6989586621679474881"><span class="annot"><span class="annottext">textSeverity :: Text
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var hs-var">textSeverity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679474875"><span class="hs-identifier hs-var">severity</span></a></span><span>
</span><span id="line-113"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Text
</span><span class="hs-identifier hs-var">showSeverity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Msg Severity -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-115"></span><span>            </span><span id="local-6989586621679474882"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">textTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-116"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>                        </span><span id="local-6989586621679474883"><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679474883"><span class="hs-identifier hs-var">zonedTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; (UTCTime -&gt; IO ZonedTime) -&gt; IO ZonedTime
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; IO ZonedTime
</span><span class="hs-identifier hs-var">utcToLocalZonedTime</span></span><span>
</span><span id="line-118"></span><span>                        </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; ZonedTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%F %T&quot;</span></span><span> </span><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679474883"><span class="hs-identifier hs-var">zonedTime</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;] &quot;</span></span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-120"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">textSeverity</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">textTime</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679474879"><span class="hs-identifier hs-var">textMessage</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-type">logMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Severity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span id="logMsg"><span class="annot"><span class="annottext">logMsg :: Severity -&gt; String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var hs-var">logMsg</span></a></span></span><span> </span><span id="local-6989586621679474885"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var">sev</span></a></span></span><span> </span><span id="local-6989586621679474886"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">{-
    Using asks getLogAction here gives us a bit of flexibility. If in the future we'd like to expand the
    ReaderT environment by adding more options or parameters to LogA, perhaps even the command line options,
    we can do so, we just need to adapt the HasLog instance, which tells us how to get the logAction out of the
    environment.
    -}</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">LogAction</span></span><span> </span><span id="local-6989586621679474888"><span class="annot"><span class="annottext">Msg Severity -&gt; IO ()
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">logF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; LogA) -&gt; PoseidonIO LogA
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; LogA
forall env msg (m :: * -&gt; *).
HasLog env msg m =&gt;
env -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">getLogAction</span></span><span> </span><span class="annot"><span class="annottext">(LogA -&gt; LogA) -&gt; (Env -&gt; LogA) -&gt; Env -&gt; LogA
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; LogA
</span><a href="Poseidon.Utils.html#_envLogAction"><span class="hs-identifier hs-var">_envLogAction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; PoseidonIO ()
forall a. IO a -&gt; ReaderT Env IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PoseidonIO ())
-&gt; (Msg Severity -&gt; IO ()) -&gt; Msg Severity -&gt; PoseidonIO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
(HasCallStack =&gt; IO ()) -&gt; IO ()
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ())
-&gt; (Msg Severity -&gt; IO ()) -&gt; Msg Severity -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Msg Severity -&gt; IO ()
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">logF</span></a></span><span> </span><span class="annot"><span class="annottext">(Msg Severity -&gt; PoseidonIO ()) -&gt; Msg Severity -&gt; PoseidonIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; CallStack -&gt; Text -&gt; Msg Severity
forall sev. sev -&gt; CallStack -&gt; Text -&gt; Msg sev
</span><span class="hs-identifier hs-var">Msg</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var">sev</span></a></span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-type">logWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="logWarning"><span class="annot"><span class="annottext">logWarning :: String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var hs-var">logWarning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Warning</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier hs-type">logInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="logInfo"><span class="annot"><span class="annottext">logInfo :: String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier hs-var hs-var">logInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Info</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-type">logDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span id="logDebug"><span class="annot"><span class="annottext">logDebug :: String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var hs-var">logDebug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-type">logError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="logError"><span class="annot"><span class="annottext">logError :: String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-var hs-var">logError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679474606"><span class="annot"><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier hs-type">logWithEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679474606"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogA"><span class="hs-identifier hs-type">LogA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679474606"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-146"></span><span id="logWithEnv"><span class="annot"><span class="annottext">logWithEnv :: forall (m :: * -&gt; *). MonadIO m =&gt; LogA -&gt; PoseidonIO () -&gt; m ()
</span><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier hs-var hs-var">logWithEnv</span></a></span></span><span> </span><span id="local-6989586621679474898"><span class="annot"><span class="annottext">LogA
</span><a href="#local-6989586621679474898"><span class="hs-identifier hs-var">logA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ())
-&gt; (PoseidonIO () -&gt; IO ()) -&gt; PoseidonIO () -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonIO () -&gt; Env -&gt; IO ()) -&gt; Env -&gt; PoseidonIO () -&gt; IO ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonIO () -&gt; Env -&gt; IO ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogA -&gt; Env
</span><a href="Poseidon.Utils.html#defaultEnv"><span class="hs-identifier hs-var">defaultEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LogA
</span><a href="#local-6989586621679474898"><span class="hs-identifier hs-var">logA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><span class="hs-comment">-- | A Poseidon Exception data type with several concrete constructors</span></span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="PoseidonException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-var">PoseidonException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>      </span><span id="PoseidonYamlParseException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonYamlParseException"><span class="hs-identifier hs-var">PoseidonYamlParseException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseException</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent YAML parsing errors</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageException"><span class="hs-identifier hs-var">PoseidonPackageException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent a logical error in a package</span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageVersionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageVersionException"><span class="hs-identifier hs-var">PoseidonPackageVersionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent an issue with a package version</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageMissingVersionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageMissingVersionException"><span class="hs-identifier hs-var">PoseidonPackageMissingVersionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to indicate a missing poseidonVersion field</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonIndSearchException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-var">PoseidonIndSearchException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent an error when searching for individuals or populations</span></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenotypeException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeException"><span class="hs-identifier hs-var">PoseidonGenotypeException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent errors in the genotype data</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenotypeExceptionForward"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeExceptionForward"><span class="hs-identifier hs-var">PoseidonGenotypeExceptionForward</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent errors in the genotype data forwarded from the sequence-formats library</span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonHttpExceptionForward"><span class="annot"><a href="Poseidon.Utils.html#PoseidonHttpExceptionForward"><span class="hs-identifier hs-var">PoseidonHttpExceptionForward</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HttpException</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent errors in the remote data loading forwarded from simpleHttp</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileRowException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileRowException"><span class="hs-identifier hs-var">PoseidonFileRowException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent errors when trying to parse the janno or seqSource file</span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileConsistencyException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-var">PoseidonFileConsistencyException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent consistency errors in janno or seqSource files</span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonCrossFileConsistencyException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonCrossFileConsistencyException"><span class="hs-identifier hs-var">PoseidonCrossFileConsistencyException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent inconsistencies across multiple files in a package</span></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonCollectionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonCollectionException"><span class="hs-identifier hs-var">PoseidonCollectionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent logical issues in a poseidon package Collection</span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileExistenceException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-var">PoseidonFileExistenceException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent missing files</span></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileChecksumException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-var">PoseidonFileChecksumException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent failed checksum tests</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFStatsFormatException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFStatsFormatException"><span class="hs-identifier hs-var">PoseidonFStatsFormatException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception type to represent FStat specification errors</span></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonBibTeXException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonBibTeXException"><span class="hs-identifier hs-var">PoseidonBibTeXException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to represent errors when trying to parse the .bib file</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPoseidonEntityParsingException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPoseidonEntityParsingException"><span class="hs-identifier hs-var">PoseidonPoseidonEntityParsingException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to indicate failed entity parsing</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonForgeEntitiesException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonForgeEntitiesException"><span class="hs-identifier hs-var">PoseidonForgeEntitiesException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to indicate issues in the forge selection</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonEmptyForgeException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonEmptyForgeException"><span class="hs-identifier hs-var">PoseidonEmptyForgeException</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to throw if there is nothing to be forged</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonNewPackageConstructionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonNewPackageConstructionException"><span class="hs-identifier hs-var">PoseidonNewPackageConstructionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to indicate an issue in newPackageTemplate</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonRemoteJSONParsingException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonRemoteJSONParsingException"><span class="hs-identifier hs-var">PoseidonRemoteJSONParsingException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to indicate failed remote info JSON parsing</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenericException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenericException"><span class="hs-identifier hs-var">PoseidonGenericException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ A catch-all for any other type of exception</span></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonEmptyOutPacNameException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonEmptyOutPacNameException"><span class="hs-identifier hs-var">PoseidonEmptyOutPacNameException</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to throw if the output package lacks a name</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonUnequalBaseDirException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnequalBaseDirException"><span class="hs-identifier hs-var">PoseidonUnequalBaseDirException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to throw if genotype data files don't share a common base directory</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonServerCommunicationException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonServerCommunicationException"><span class="hs-identifier hs-var">PoseidonServerCommunicationException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception to mark server communication errors</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonUnzipException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnzipException"><span class="hs-identifier hs-var">PoseidonUnzipException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception for unzipping issues in fetch</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonChronicleException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonChronicleException"><span class="hs-identifier hs-var">PoseidonChronicleException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception for issues in chronicle</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGitException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGitException"><span class="hs-identifier hs-var">PoseidonGitException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An exception for issues with git</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474929"><span id="local-6989586621679474993"><span id="local-6989586621679474997"><span class="annot"><span class="annottext">Int -&gt; PoseidonException -&gt; ShowS
[PoseidonException] -&gt; ShowS
PoseidonException -&gt; String
(Int -&gt; PoseidonException -&gt; ShowS)
-&gt; (PoseidonException -&gt; String)
-&gt; ([PoseidonException] -&gt; ShowS)
-&gt; Show PoseidonException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; PoseidonException -&gt; ShowS
showsPrec :: Int -&gt; PoseidonException -&gt; ShowS
$cshow :: PoseidonException -&gt; String
show :: PoseidonException -&gt; String
$cshowList :: [PoseidonException] -&gt; ShowS
showList :: [PoseidonException] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679475004"><span id="local-6989586621679475007"><span id="local-6989586621679475010"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span></span></span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-type">renderPoseidonException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-183"></span><span id="renderPoseidonException"><span class="annot"><span class="annottext">renderPoseidonException :: PoseidonException -&gt; String
</span><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var hs-var">renderPoseidonException</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonYamlParseException"><span class="hs-identifier hs-type">PoseidonYamlParseException</span></a></span><span> </span><span id="local-6989586621679475013"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475013"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679475014"><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679475014"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not parse YAML file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475013"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ParseException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679475014"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageException"><span class="hs-identifier hs-type">PoseidonPackageException</span></a></span><span> </span><span id="local-6989586621679475016"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475016"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Encountered a logical error with a poseidon package: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475016"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageVersionException"><span class="hs-identifier hs-type">PoseidonPackageVersionException</span></a></span><span> </span><span id="local-6989586621679475017"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475017"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679475018"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475018"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Poseidon version mismatch in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475017"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. This package is build according to poseidon schema v&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475018"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, which is not supported by poseidon-hs v&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; String
</span><span class="hs-identifier hs-var">showVersion</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Paths_poseidon_hs.html#version"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. Modify the package, or switch to a newer (or older) version of this software.&quot;</span></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageMissingVersionException"><span class="hs-identifier hs-type">PoseidonPackageMissingVersionException</span></a></span><span> </span><span id="local-6989586621679475019"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475019"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The POSEIDON.yml file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475019"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has no poseidonVersion field. &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is mandatory.&quot;</span></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-type">PoseidonIndSearchException</span></a></span><span> </span><span id="local-6989586621679475020"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475020"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475020"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeException"><span class="hs-identifier hs-type">PoseidonGenotypeException</span></a></span><span> </span><span id="local-6989586621679475021"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475021"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Genotype data structurally inconsistent: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475021"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeExceptionForward"><span class="hs-identifier hs-type">PoseidonGenotypeExceptionForward</span></a></span><span> </span><span id="local-6989586621679475022"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679475022"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Issues in genotype data parsing: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679475022"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonHttpExceptionForward"><span class="hs-identifier hs-type">PoseidonHttpExceptionForward</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HttpExceptionRequest</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679475024"><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="#local-6989586621679475024"><span class="hs-identifier hs-var">content</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Issues in HTTP-communication with server:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="#local-6989586621679475024"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonHttpExceptionForward"><span class="hs-identifier hs-type">PoseidonHttpExceptionForward</span></a></span><span> </span><span id="local-6989586621679475025"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679475025"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Issues in HTTP-communication with server: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679475025"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileRowException"><span class="hs-identifier hs-type">PoseidonFileRowException</span></a></span><span> </span><span id="local-6989586621679475026"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475026"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679475027"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475027"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679475028"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475028"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't read sample in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475026"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475027"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475028"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-type">PoseidonFileConsistencyException</span></a></span><span> </span><span id="local-6989586621679475029"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475029"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679475030"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475030"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Consistency issues in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475029"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475030"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonCrossFileConsistencyException"><span class="hs-identifier hs-type">PoseidonCrossFileConsistencyException</span></a></span><span> </span><span id="local-6989586621679475031"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475031"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679475032"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475032"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cross-file consistency issue in package &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475031"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475032"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonCollectionException"><span class="hs-identifier hs-type">PoseidonCollectionException</span></a></span><span> </span><span id="local-6989586621679475033"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475033"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The package collection is broken: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475033"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-type">PoseidonFileExistenceException</span></a></span><span> </span><span id="local-6989586621679475034"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475034"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;File &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475034"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not exist&quot;</span></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-type">PoseidonFileChecksumException</span></a></span><span> </span><span id="local-6989586621679475035"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475035"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;File checksum test failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475035"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFStatsFormatException"><span class="hs-identifier hs-type">PoseidonFStatsFormatException</span></a></span><span> </span><span id="local-6989586621679475036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475036"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fstat specification error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475036"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonBibTeXException"><span class="hs-identifier hs-type">PoseidonBibTeXException</span></a></span><span> </span><span id="local-6989586621679475037"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475037"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679475038"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475038"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BibTex problem in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475037"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475038"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPoseidonEntityParsingException"><span class="hs-identifier hs-type">PoseidonPoseidonEntityParsingException</span></a></span><span> </span><span id="local-6989586621679475039"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475039"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when parsing the forge selection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475039"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonForgeEntitiesException"><span class="hs-identifier hs-type">PoseidonForgeEntitiesException</span></a></span><span> </span><span id="local-6989586621679475040"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475040"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in the forge selection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475040"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonEmptyForgeException"><span class="hs-identifier hs-var">PoseidonEmptyForgeException</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nothing to be forged&quot;</span></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonNewPackageConstructionException"><span class="hs-identifier hs-type">PoseidonNewPackageConstructionException</span></a></span><span> </span><span id="local-6989586621679475041"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475041"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonRemoteJSONParsingException"><span class="hs-identifier hs-type">PoseidonRemoteJSONParsingException</span></a></span><span> </span><span id="local-6989586621679475042"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475042"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in parsing JSON: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475042"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-232"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenericException"><span class="hs-identifier hs-type">PoseidonGenericException</span></a></span><span> </span><span id="local-6989586621679475043"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475043"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475043"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonEmptyOutPacNameException"><span class="hs-identifier hs-var">PoseidonEmptyOutPacNameException</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when preparing the new package: The output package does not have a name. Add one with: -n YourPackageName&quot;</span></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnequalBaseDirException"><span class="hs-identifier hs-type">PoseidonUnequalBaseDirException</span></a></span><span> </span><span id="local-6989586621679475044"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475044"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679475045"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475045"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679475046"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475046"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The base directories of these genotype files are not equal.&quot;</span></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --genoFile: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475044"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --snpFile: &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475045"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --indFile: &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475046"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonServerCommunicationException"><span class="hs-identifier hs-type">PoseidonServerCommunicationException</span></a></span><span> </span><span id="local-6989586621679475047"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475047"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475047"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnzipException"><span class="hs-identifier hs-type">PoseidonUnzipException</span></a></span><span> </span><span id="local-6989586621679475048"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679475048"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error during unzipping: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679475048"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-243"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonChronicleException"><span class="hs-identifier hs-type">PoseidonChronicleException</span></a></span><span> </span><span id="local-6989586621679475049"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475049"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when preparing the chronicle file: &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475049"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGitException"><span class="hs-identifier hs-type">PoseidonGitException</span></a></span><span> </span><span id="local-6989586621679475050"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475050"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679475051"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475051"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to load .git directory in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475050"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475051"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- helper function to check if a file exists</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier hs-type">checkFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span id="checkFile"><span class="annot"><span class="annottext">checkFile :: String -&gt; Maybe String -&gt; IO ()
</span><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier hs-var hs-var">checkFile</span></a></span></span><span> </span><span id="local-6989586621679475052"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475052"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679475053"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679475053"><span class="hs-identifier hs-var">maybeChkSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679475054"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679475054"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475052"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679475054"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-var">PoseidonFileExistenceException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475052"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679475053"><span class="hs-identifier hs-var">maybeChkSum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679475056"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475056"><span class="hs-identifier hs-var">chkSum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>                </span><span id="local-6989586621679475057"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475057"><span class="hs-identifier hs-var">fnChkSum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-var">getChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475052"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-259"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475057"><span class="hs-identifier hs-var">fnChkSum</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475056"><span class="hs-identifier hs-var">chkSum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-var">PoseidonFileChecksumException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475052"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- helper functions to get the checksum of a file</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-type">getChecksum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-263"></span><span id="getChecksum"><span class="annot"><span class="annottext">getChecksum :: String -&gt; IO String
</span><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-var hs-var">getChecksum</span></a></span></span><span> </span><span id="local-6989586621679475058"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475058"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679475059"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679475059"><span class="hs-identifier hs-var">fileContent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><span class="hs-identifier hs-var">LB.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475058"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679475061"><span class="annot"><span class="annottext">md5Digest :: MD5Digest
</span><a href="#local-6989586621679475061"><span class="hs-identifier hs-var hs-var">md5Digest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MD5Digest
</span><span class="hs-identifier hs-var">md5</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679475059"><span class="hs-identifier hs-var">fileContent</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MD5Digest -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MD5Digest
</span><a href="#local-6989586621679475061"><span class="hs-identifier hs-var">md5Digest</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- helper functions to pad and cut strings</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Poseidon.Utils.html#padRight"><span class="hs-identifier hs-type">padRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-270"></span><span id="padRight"><span class="annot"><span class="annottext">padRight :: Int -&gt; ShowS
</span><a href="Poseidon.Utils.html#padRight"><span class="hs-identifier hs-var hs-var">padRight</span></a></span></span><span> </span><span id="local-6989586621679475062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475062"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679475063"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475062"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475062"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475062"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475062"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475063"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Poseidon.Utils.html#padLeft"><span class="hs-identifier hs-type">padLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-276"></span><span id="padLeft"><span class="annot"><span class="annottext">padLeft :: Int -&gt; ShowS
</span><a href="Poseidon.Utils.html#padLeft"><span class="hs-identifier hs-var hs-var">padLeft</span></a></span></span><span> </span><span id="local-6989586621679475068"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475068"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679475069"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679475068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475069"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- helper function to determine the package name depending on -n and -o</span><span>
</span><span id="line-282"></span><span class="annot"><a href="Poseidon.Utils.html#determinePackageOutName"><span class="hs-identifier hs-type">determinePackageOutName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-283"></span><span id="determinePackageOutName"><span class="annot"><span class="annottext">determinePackageOutName :: Maybe String -&gt; String -&gt; IO String
</span><a href="Poseidon.Utils.html#determinePackageOutName"><span class="hs-identifier hs-var hs-var">determinePackageOutName</span></a></span></span><span> </span><span id="local-6989586621679475071"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679475071"><span class="hs-identifier hs-var">maybeOutName</span></a></span></span><span> </span><span id="local-6989586621679475072"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475072"><span class="hs-identifier hs-var">outPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679475071"><span class="hs-identifier hs-var">maybeOutName</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- take basename of outPath, if name is not provided</span><span>
</span><span id="line-285"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679475073"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475073"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475073"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeBaseName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475072"><span class="hs-identifier hs-var">outPath</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- check if outPath is empty</span><span>
</span><span id="line-287"></span><span>                </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO String
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonEmptyOutPacNameException"><span class="hs-identifier hs-var">PoseidonEmptyOutPacNameException</span></a></span><span>
</span><span id="line-288"></span><span>                </span><span id="local-6989586621679475074"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475074"><span class="hs-identifier hs-var">y</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679475074"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- two helper functions to reduce a lists to the unique elements in it</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- see https://github.com/nh2/haskell-ordnub#dont-use-nub</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- preserves the original order</span><span>
</span><span id="line-293"></span><span id="local-6989586621679474623"><span class="annot"><a href="Poseidon.Utils.html#uniquePO"><span class="hs-identifier hs-type">uniquePO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679474623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679474623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679474623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-294"></span><span id="uniquePO"><span class="annot"><span class="annottext">uniquePO :: forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="Poseidon.Utils.html#uniquePO"><span class="hs-identifier hs-var hs-var">uniquePO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a]
forall {a}. Ord a =&gt; Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679475077"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679475077"><span class="annot"><span class="annottext">go :: Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679475077"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="#local-6989586621679475077"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679475085"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679475085"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679475086"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475086"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679475087"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475087"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475086"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679475085"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679475077"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679475085"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475087"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475086"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679475077"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475086"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679475085"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475087"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- reorderes the list according to the Ord instance of a</span><span>
</span><span id="line-303"></span><span id="local-6989586621679475090"><span class="annot"><a href="Poseidon.Utils.html#uniqueRO"><span class="hs-identifier hs-type">uniqueRO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679475090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679475090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679475090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-304"></span><span id="uniqueRO"><span class="annot"><span class="annottext">uniqueRO :: forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="Poseidon.Utils.html#uniqueRO"><span class="hs-identifier hs-var hs-var">uniqueRO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; [a]) -&gt; ([a] -&gt; Set a) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Set a
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-305"></span></pre></body></html>